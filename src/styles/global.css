@import "tailwindcss";
/* config for tailwindcss-typography plugin */
@config "../../tailwind.config.ts";

/* use a selector-based strategy for dark mode */
@custom-variant dark (&:where([data-theme="dark"], [data-theme="dark"] *));

/* you could refactor below to use light-dark(), depending on your target audience */
@theme {
	--color-global-bg: #fff8eb;
	--color-global-text: oklch(26.99% 0.0096 235.05);
	--color-link: oklch(55.44% 0.0431 185.69);
	--color-accent: oklch(55.27% 0.195 19.06);
	--color-accent-2: oklch(18.15% 0 0);
	--color-quote: #8953d1;
}

@layer base {
	html {
		color-scheme: light dark;
		accent-color: var(--color-accent);
		scrollbar-gutter: stable;

		&[data-theme="light"] {
			color-scheme: light;
		}

		&[data-theme="dark"] {
			color-scheme: dark;
			--color-global-bg: #151515;
			--color-global-text: oklch(83.54% 0 264);
			--color-link: oklch(70.44% 0.1133 349);
			--color-accent: oklch(70.91% 0.1415 163.7);
			--color-accent-2: oklch(94.66% 0 0);
			--color-quote: #e7ddf6;
		}
	}

	:target {
		scroll-margin-block: 5ex;
	}

	@view-transition {
		navigation: auto;
	}

	/* Astro image responsive styles, modified from -> https://docs.astro.build/en/guides/images/#responsive-image-styles */
	:where([data-astro-image]) {
		object-fit: var(--fit);
		object-position: var(--pos);
	}
	[data-astro-image="full-width"] {
		width: 100%;
	}
	[data-astro-image="constrained"] {
		max-width: 100%;
	}
}

@layer components {
	@import "./components/admonition.css";
	@import "./components/github-card.css";

	.cactus-link {
		@apply hover:decoration-link underline underline-offset-2 hover:decoration-2;
	}

	.title {
		@apply text-accent-2 text-2xl font-semibold;
	}
}

@utility prose {
	--tw-prose-body: var(--color-global-text);
	--tw-prose-bold: var(--color-global-text);
	--tw-prose-bullets: var(--color-global-text);
	--tw-prose-code: var(--color-global-text);
	--tw-prose-headings: var(--color-accent-2);
	--tw-prose-hr: 0.5px dashed #666;
	--tw-prose-links: var(--color-global-text);
	--tw-prose-quotes: var(--color-quote);
	--tw-prose-th-borders: #666;
}

/* ==========================================================================
   5 Animation Effects for Rex Liu's Website
   These styles are outside @layer to ensure they're always included
   ========================================================================== */

/* --------------------------------------------------------------------------
   1. Text Reveal Animation (Hero Section)
   -------------------------------------------------------------------------- */

/* Character-level reveal for main title */
.char-reveal {
	display: inline-block;
	opacity: 0;
	transform: translateY(20px);
	animation: charReveal 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
	animation-delay: calc(var(--char-index) * 40ms);
}

@keyframes charReveal {
	0% {
		opacity: 0;
		transform: translateY(20px);
	}
	100% {
		opacity: 1;
		transform: translateY(0);
	}
}

/* Word-level reveal for subtitle */
.word-reveal {
	display: inline-block;
	opacity: 0;
	transform: translateY(12px);
	animation: wordReveal 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
	animation-delay: calc(var(--word-index) * 1s);
}

@keyframes wordReveal {
	0% {
		opacity: 0;
		transform: translateY(12px);
	}
	100% {
		opacity: 1;
		transform: translateY(0);
	}
}

/* Trigger class for JS control */
.hero-reveal-text.revealed .char-reveal,
.hero-reveal-subtitle.revealed .word-reveal {
	animation-play-state: running;
}

/* --------------------------------------------------------------------------
   2. Post Card Base (hover lift removed per Rex's request)
   -------------------------------------------------------------------------- */

/* --------------------------------------------------------------------------
   3. Scroll-Triggered Fade-in Animations
   -------------------------------------------------------------------------- */

.fade-in-up,
.fade-in,
.stagger-fade {
	opacity: 0;
	transition:
		opacity 400ms cubic-bezier(0.4, 0, 0.2, 1),
		transform 400ms cubic-bezier(0.4, 0, 0.2, 1);
	transition-delay: var(--delay, 0ms);
}

.fade-in-up {
	transform: translateY(16px);
}

.stagger-fade {
	transform: translateY(20px);
}

.fade-in {
	transform: none;
}

.fade-in-up.visible,
.fade-in.visible,
.stagger-fade.visible {
	opacity: 1;
	transform: translateY(0);
}

/* --------------------------------------------------------------------------
   4. Animated Link Underline (Purple underline from left)
   -------------------------------------------------------------------------- */

.animated-link,
.prose a:not(.no-underline),
article a:not(.no-underline) {
	position: relative;
	text-decoration: none;
}

.animated-link::after,
.prose a:not(.no-underline)::after,
article a:not(.no-underline)::after {
	content: '';
	position: absolute;
	left: 0;
	bottom: -2px;
	width: 100%;
	height: 1.5px;
	background-color: #8953d1;
	transform: scaleX(0);
	transform-origin: right;
	transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.animated-link:hover::after,
.prose a:not(.no-underline):hover::after,
article a:not(.no-underline):hover::after {
	transform: scaleX(1);
	transform-origin: left;
}

/* Dark mode underline color */
[data-theme="dark"] .animated-link::after,
[data-theme="dark"] .prose a:not(.no-underline)::after,
[data-theme="dark"] article a:not(.no-underline)::after {
	background-color: #a175e8;
}

/* For links that already have explicit underline styling, respect it */
a.cactus-link::after,
header a::after,
footer a::after,
nav a::after {
	display: none;
}

/* --------------------------------------------------------------------------
   5. Smooth Dark Mode Transition
   -------------------------------------------------------------------------- */

html,
html * {
	transition:
		background-color 0.4s ease,
		color 0.4s ease,
		border-color 0.4s ease,
		box-shadow 0.4s ease;
}

/* Prevent transition on initial load */
html:not(.theme-loaded) *,
html:not(.theme-loaded) {
	transition: none !important;
}

/* During theme transition - enhance smoothness */
html.theme-transitioning,
html.theme-transitioning * {
	transition:
		background-color 0.5s ease,
		color 0.5s ease,
		border-color 0.5s ease,
		box-shadow 0.5s ease !important;
}

/* ==========================================================================
   Mouse Glow Effect (Enhanced)
   ========================================================================== */

.glow-card {
	position: relative;
	--mouse-x: -999px;
	--mouse-y: -999px;
}

.glow-card::before {
	content: "";
	position: absolute;
	inset: 0;
	border-radius: 8px;
	background: radial-gradient(
		400px circle at var(--mouse-x) var(--mouse-y),
		rgba(137, 83, 209, 0.08),
		transparent 40%
	);
	opacity: 0;
	transition: opacity 0.3s ease;
	pointer-events: none;
	z-index: -1;
}

.glow-card:hover::before {
	opacity: 1;
}

[data-theme="dark"] .glow-card::before {
	background: radial-gradient(
		400px circle at var(--mouse-x) var(--mouse-y),
		rgba(161, 117, 232, 0.1),
		transparent 40%
	);
}

/* ==========================================================================
   Reduced Motion Support
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {
	.char-reveal,
	.word-reveal,
	.fade-in-up,
	.fade-in,
	.stagger-fade,
	.post-card-hover,
	.glow-card,
	html,
	html * {
		opacity: 1 !important;
		transform: none !important;
		animation: none !important;
		transition: none !important;
	}
}

/* ==========================================================================
   Print Styles
   ========================================================================== */

@media print {
	/* Hide non-essential elements */
	header,
	footer,
	#minimal-player,
	#back-to-top,
	#reading-progress,
	.activity-wrapper,
	.related-posts {
		display: none !important;
	}

	/* Reset background colors and shadows */
	* {
		background: white !important;
		box-shadow: none !important;
		text-shadow: none !important;
	}

	/* Use black text for better print quality */
	body {
		color: #000 !important;
		font-size: 12pt;
		line-height: 1.5;
	}

	/* Optimize page breaks */
	h1,
	h2,
	h3,
	h4,
	h5,
	h6 {
		page-break-after: avoid;
		page-break-inside: avoid;
		color: #000 !important;
	}

	p,
	blockquote,
	pre {
		page-break-inside: avoid;
	}

	img {
		page-break-inside: avoid;
		max-width: 100% !important;
	}

	/* Show link URLs after links */
	a[href^="http"]::after {
		content: " (" attr(href) ")";
		font-size: 0.8em;
		color: #666;
	}

	/* Don't show URLs for internal links or anchors */
	a[href^="#"]::after,
	a[href^="/"]::after {
		content: "";
	}

	/* Code blocks */
	pre {
		border: 1px solid #ddd !important;
		page-break-inside: avoid;
		white-space: pre-wrap;
		word-wrap: break-word;
	}

	/* Tables */
	table {
		border-collapse: collapse !important;
	}

	table td,
	table th {
		border: 1px solid #ddd !important;
		padding: 8px !important;
	}

	/* Remove unnecessary margins */
	@page {
		margin: 2cm;
	}

	/* Ensure main content takes full width */
	main {
		max-width: 100% !important;
		padding: 0 !important;
		margin: 0 !important;
	}
}
